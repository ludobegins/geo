import { Directive, EventEmitter, Input, Output } from '@angular/core';
import { Control, Draw, drawLocal } from 'leaflet';
import 'leaflet-draw';
import { LeafletDirectiveWrapper, LeafletUtil } from '@asymmetrik/ngx-leaflet';
import { LeafletDrawUtil } from './leaflet-draw.util';
import * as i0 from "@angular/core";
import * as i1 from "@asymmetrik/ngx-leaflet";
export class LeafletDrawDirective {
    constructor(leafletDirective, zone) {
        this.zone = zone;
        this.drawOptions = null;
        // Using 'any' here to avoid duplicating the DrawLocal interface with a bunch of optional properties
        this.drawLocal = null;
        // Configure callback function for the map
        this.drawReady = new EventEmitter();
        // Draw Events
        this.onDrawCreated = new EventEmitter();
        this.onDrawEdited = new EventEmitter();
        this.onDrawDeleted = new EventEmitter();
        this.onDrawStart = new EventEmitter();
        this.onDrawStop = new EventEmitter();
        this.onDrawVertex = new EventEmitter();
        this.onDrawEditStart = new EventEmitter();
        this.onDrawEditMove = new EventEmitter();
        this.onDrawEditResize = new EventEmitter();
        this.onDrawEditVertex = new EventEmitter();
        this.onDrawEditStop = new EventEmitter();
        this.onDrawDeleteStart = new EventEmitter();
        this.onDrawDeleteStop = new EventEmitter();
        this.onDrawToolbarOpened = new EventEmitter();
        this.onDrawToolbarClosed = new EventEmitter();
        this.onDrawMarkerContext = new EventEmitter();
        this.leafletDirective = new LeafletDirectiveWrapper(leafletDirective);
    }
    ngOnInit() {
        this.leafletDirective.init();
        // Configure localization options
        if (null != this.drawLocal) {
            LeafletDrawUtil.deepLiteralCopy(drawLocal, this.drawLocal);
        }
        // Create the control
        this.drawControl = new Control.Draw(this.drawOptions);
        // Add the control to the map
        this.leafletDirective.getMap().addControl(this.drawControl);
        // Register the main handler for events coming from the draw plugin
        const map = this.leafletDirective.getMap();
        // add draw event pass throughs
        map.on(Draw.Event.CREATED, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawCreated, e));
        map.on(Draw.Event.EDITED, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawEdited, e));
        map.on(Draw.Event.DELETED, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawDeleted, e));
        map.on(Draw.Event.DRAWSTART, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawStart, e));
        map.on(Draw.Event.DRAWSTOP, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawStop, e));
        map.on(Draw.Event.EDITSTART, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawEditStart, e));
        map.on(Draw.Event.EDITMOVE, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawEditMove, e));
        map.on(Draw.Event.EDITRESIZE, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawEditResize, e));
        map.on(Draw.Event.EDITVERTEX, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawEditVertex, e));
        map.on(Draw.Event.EDITSTOP, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawEditStop, e));
        map.on(Draw.Event.DELETESTART, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawDeleteStart, e));
        map.on(Draw.Event.DELETESTOP, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawDeleteStop, e));
        map.on(Draw.Event.TOOLBAROPENED, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawToolbarOpened, e));
        map.on(Draw.Event.TOOLBARCLOSED, (e) => LeafletUtil.handleEvent(this.zone, this.onDrawToolbarClosed, e));
        // Notify others that the draw control has been created
        this.drawReady.emit(this.drawControl);
    }
    ngOnDestroy() {
        this.leafletDirective.getMap().removeControl(this.drawControl);
    }
    getDrawControl() {
        return this.drawControl;
    }
}
LeafletDrawDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.3", ngImport: i0, type: LeafletDrawDirective, deps: [{ token: i1.LeafletDirective }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Directive });
LeafletDrawDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "13.2.3", type: LeafletDrawDirective, selector: "[leafletDraw]", inputs: { drawOptions: ["leafletDrawOptions", "drawOptions"], drawLocal: ["leafletDrawLocal", "drawLocal"] }, outputs: { drawReady: "leafletDrawReady", onDrawCreated: "leafletDrawCreated", onDrawEdited: "leafletDrawEdited", onDrawDeleted: "leafletDrawDeleted", onDrawStart: "leafletDrawStart", onDrawStop: "leafletDrawStop", onDrawVertex: "leafletDrawVertex", onDrawEditStart: "leafletDrawEditStart", onDrawEditMove: "leafletDrawEditMove", onDrawEditResize: "leafletDrawEditResize", onDrawEditVertex: "leafletDrawEditVertex", onDrawEditStop: "leafletDrawEditStop", onDrawDeleteStart: "leafletDrawDeleteStart", onDrawDeleteStop: "leafletDrawDeleteStop", onDrawToolbarOpened: "leafletDrawToolbarOpened", onDrawToolbarClosed: "leafletDrawToolbarClosed", onDrawMarkerContext: "leafletDrawMarkerContext" }, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.3", ngImport: i0, type: LeafletDrawDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[leafletDraw]'
                }]
        }], ctorParameters: function () { return [{ type: i1.LeafletDirective }, { type: i0.NgZone }]; }, propDecorators: { drawOptions: [{
                type: Input,
                args: ['leafletDrawOptions']
            }], drawLocal: [{
                type: Input,
                args: ['leafletDrawLocal']
            }], drawReady: [{
                type: Output,
                args: ['leafletDrawReady']
            }], onDrawCreated: [{
                type: Output,
                args: ['leafletDrawCreated']
            }], onDrawEdited: [{
                type: Output,
                args: ['leafletDrawEdited']
            }], onDrawDeleted: [{
                type: Output,
                args: ['leafletDrawDeleted']
            }], onDrawStart: [{
                type: Output,
                args: ['leafletDrawStart']
            }], onDrawStop: [{
                type: Output,
                args: ['leafletDrawStop']
            }], onDrawVertex: [{
                type: Output,
                args: ['leafletDrawVertex']
            }], onDrawEditStart: [{
                type: Output,
                args: ['leafletDrawEditStart']
            }], onDrawEditMove: [{
                type: Output,
                args: ['leafletDrawEditMove']
            }], onDrawEditResize: [{
                type: Output,
                args: ['leafletDrawEditResize']
            }], onDrawEditVertex: [{
                type: Output,
                args: ['leafletDrawEditVertex']
            }], onDrawEditStop: [{
                type: Output,
                args: ['leafletDrawEditStop']
            }], onDrawDeleteStart: [{
                type: Output,
                args: ['leafletDrawDeleteStart']
            }], onDrawDeleteStop: [{
                type: Output,
                args: ['leafletDrawDeleteStop']
            }], onDrawToolbarOpened: [{
                type: Output,
                args: ['leafletDrawToolbarOpened']
            }], onDrawToolbarClosed: [{
                type: Output,
                args: ['leafletDrawToolbarClosed']
            }], onDrawMarkerContext: [{
                type: Output,
                args: ['leafletDrawMarkerContext']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGVhZmxldC1kcmF3LmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1sZWFmbGV0LWRyYXcvc3JjL2xpYi9jb3JlL2xlYWZsZXQtZHJhdy5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFrQixNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFdkYsT0FBTyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQWMsU0FBUyxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQy9ELE9BQU8sY0FBYyxDQUFDO0FBRXRCLE9BQU8sRUFBb0IsdUJBQXVCLEVBQUUsV0FBVyxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFFakcsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDOzs7QUFLdEQsTUFBTSxPQUFPLG9CQUFvQjtJQWlDaEMsWUFBWSxnQkFBa0MsRUFBVSxJQUFZO1FBQVosU0FBSSxHQUFKLElBQUksQ0FBUTtRQTFCdkMsZ0JBQVcsR0FBbUMsSUFBSSxDQUFDO1FBRWhGLG9HQUFvRztRQUN6RSxjQUFTLEdBQVEsSUFBSSxDQUFDO1FBRWpELDBDQUEwQztRQUNkLGNBQVMsR0FBRyxJQUFJLFlBQVksRUFBZ0IsQ0FBQztRQUV6RSxjQUFjO1FBQ2dCLGtCQUFhLEdBQUcsSUFBSSxZQUFZLEVBQXNCLENBQUM7UUFDeEQsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBcUIsQ0FBQztRQUNwRCxrQkFBYSxHQUFHLElBQUksWUFBWSxFQUFzQixDQUFDO1FBQ3pELGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQXdCLENBQUM7UUFDeEQsZUFBVSxHQUFHLElBQUksWUFBWSxFQUF1QixDQUFDO1FBQ25ELGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQXlCLENBQUM7UUFDdEQsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBd0IsQ0FBQztRQUM1RCxtQkFBYyxHQUFHLElBQUksWUFBWSxFQUF1QixDQUFDO1FBQ3ZELHFCQUFnQixHQUFHLElBQUksWUFBWSxFQUF5QixDQUFDO1FBQzdELHFCQUFnQixHQUFHLElBQUksWUFBWSxFQUF5QixDQUFDO1FBQy9ELG1CQUFjLEdBQUcsSUFBSSxZQUFZLEVBQXVCLENBQUM7UUFDdEQsc0JBQWlCLEdBQUcsSUFBSSxZQUFZLEVBQTBCLENBQUM7UUFDaEUscUJBQWdCLEdBQUcsSUFBSSxZQUFZLEVBQXlCLENBQUM7UUFDMUQsd0JBQW1CLEdBQUcsSUFBSSxZQUFZLEVBQTRCLENBQUM7UUFDbkUsd0JBQW1CLEdBQUcsSUFBSSxZQUFZLEVBQTRCLENBQUM7UUFDbkUsd0JBQW1CLEdBQUcsSUFBSSxZQUFZLEVBQTRCLENBQUM7UUFHdEcsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksdUJBQXVCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUN2RSxDQUFDO0lBRUQsUUFBUTtRQUNQLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUU3QixpQ0FBaUM7UUFDakMsSUFBRyxJQUFJLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUMxQixlQUFlLENBQUMsZUFBZSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDM0Q7UUFFRCxxQkFBcUI7UUFDckIsSUFBSSxDQUFDLFdBQVcsR0FBSSxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBRXZELDZCQUE2QjtRQUM3QixJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUU1RCxtRUFBbUU7UUFDbkUsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxDQUFDO1FBRTNDLCtCQUErQjtRQUMvQixHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBTSxFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xHLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFvQixFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlHLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFxQixFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pILEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUF1QixFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25ILEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFzQixFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2hILEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUF1QixFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3ZILEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFzQixFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3BILEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUF3QixFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUgsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQXdCLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxSCxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBc0IsRUFBRSxFQUFFLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwSCxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBeUIsRUFBRSxFQUFFLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdILEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUF3QixFQUFFLEVBQUUsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUgsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQTJCLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuSSxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBMkIsRUFBRSxFQUFFLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRW5JLHVEQUF1RDtRQUN2RCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUVELFdBQVc7UUFDVixJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNoRSxDQUFDO0lBRU0sY0FBYztRQUNwQixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDekIsQ0FBQzs7aUhBaEZXLG9CQUFvQjtxR0FBcEIsb0JBQW9COzJGQUFwQixvQkFBb0I7a0JBSGhDLFNBQVM7bUJBQUM7b0JBQ1YsUUFBUSxFQUFFLGVBQWU7aUJBQ3pCOzRIQVE2QixXQUFXO3NCQUF2QyxLQUFLO3VCQUFDLG9CQUFvQjtnQkFHQSxTQUFTO3NCQUFuQyxLQUFLO3VCQUFDLGtCQUFrQjtnQkFHRyxTQUFTO3NCQUFwQyxNQUFNO3VCQUFDLGtCQUFrQjtnQkFHSSxhQUFhO3NCQUExQyxNQUFNO3VCQUFDLG9CQUFvQjtnQkFDQyxZQUFZO3NCQUF4QyxNQUFNO3VCQUFDLG1CQUFtQjtnQkFDRyxhQUFhO3NCQUExQyxNQUFNO3VCQUFDLG9CQUFvQjtnQkFDQSxXQUFXO3NCQUF0QyxNQUFNO3VCQUFDLGtCQUFrQjtnQkFDQyxVQUFVO3NCQUFwQyxNQUFNO3VCQUFDLGlCQUFpQjtnQkFDSSxZQUFZO3NCQUF4QyxNQUFNO3VCQUFDLG1CQUFtQjtnQkFDSyxlQUFlO3NCQUE5QyxNQUFNO3VCQUFDLHNCQUFzQjtnQkFDQyxjQUFjO3NCQUE1QyxNQUFNO3VCQUFDLHFCQUFxQjtnQkFDSSxnQkFBZ0I7c0JBQWhELE1BQU07dUJBQUMsdUJBQXVCO2dCQUNFLGdCQUFnQjtzQkFBaEQsTUFBTTt1QkFBQyx1QkFBdUI7Z0JBQ0EsY0FBYztzQkFBNUMsTUFBTTt1QkFBQyxxQkFBcUI7Z0JBQ0ssaUJBQWlCO3NCQUFsRCxNQUFNO3VCQUFDLHdCQUF3QjtnQkFDQyxnQkFBZ0I7c0JBQWhELE1BQU07dUJBQUMsdUJBQXVCO2dCQUNLLG1CQUFtQjtzQkFBdEQsTUFBTTt1QkFBQywwQkFBMEI7Z0JBQ0UsbUJBQW1CO3NCQUF0RCxNQUFNO3VCQUFDLDBCQUEwQjtnQkFDRSxtQkFBbUI7c0JBQXRELE1BQU07dUJBQUMsMEJBQTBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBFdmVudEVtaXR0ZXIsIElucHV0LCBOZ1pvbmUsIE9uSW5pdCwgT3V0cHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IENvbnRyb2wsIERyYXcsIERyYXdFdmVudHMsIGRyYXdMb2NhbCB9IGZyb20gJ2xlYWZsZXQnO1xuaW1wb3J0ICdsZWFmbGV0LWRyYXcnO1xuXG5pbXBvcnQgeyBMZWFmbGV0RGlyZWN0aXZlLCBMZWFmbGV0RGlyZWN0aXZlV3JhcHBlciwgTGVhZmxldFV0aWwgfSBmcm9tICdAYXN5bW1ldHJpay9uZ3gtbGVhZmxldCc7XG5cbmltcG9ydCB7IExlYWZsZXREcmF3VXRpbCB9IGZyb20gJy4vbGVhZmxldC1kcmF3LnV0aWwnO1xuXG5ARGlyZWN0aXZlKHtcblx0c2VsZWN0b3I6ICdbbGVhZmxldERyYXddJ1xufSlcbmV4cG9ydCBjbGFzcyBMZWFmbGV0RHJhd0RpcmVjdGl2ZVxuXHRpbXBsZW1lbnRzIE9uSW5pdCB7XG5cblx0bGVhZmxldERpcmVjdGl2ZTogTGVhZmxldERpcmVjdGl2ZVdyYXBwZXI7XG5cblx0ZHJhd0NvbnRyb2w6IENvbnRyb2wuRHJhdztcblxuXHRASW5wdXQoJ2xlYWZsZXREcmF3T3B0aW9ucycpIGRyYXdPcHRpb25zOiBDb250cm9sLkRyYXdDb25zdHJ1Y3Rvck9wdGlvbnMgPSBudWxsO1xuXG5cdC8vIFVzaW5nICdhbnknIGhlcmUgdG8gYXZvaWQgZHVwbGljYXRpbmcgdGhlIERyYXdMb2NhbCBpbnRlcmZhY2Ugd2l0aCBhIGJ1bmNoIG9mIG9wdGlvbmFsIHByb3BlcnRpZXNcblx0QElucHV0KCdsZWFmbGV0RHJhd0xvY2FsJykgZHJhd0xvY2FsOiBhbnkgPSBudWxsO1xuXG5cdC8vIENvbmZpZ3VyZSBjYWxsYmFjayBmdW5jdGlvbiBmb3IgdGhlIG1hcFxuXHRAT3V0cHV0KCdsZWFmbGV0RHJhd1JlYWR5JykgZHJhd1JlYWR5ID0gbmV3IEV2ZW50RW1pdHRlcjxDb250cm9sLkRyYXc+KCk7XG5cblx0Ly8gRHJhdyBFdmVudHNcblx0QE91dHB1dCgnbGVhZmxldERyYXdDcmVhdGVkJykgb25EcmF3Q3JlYXRlZCA9IG5ldyBFdmVudEVtaXR0ZXI8RHJhd0V2ZW50cy5DcmVhdGVkPigpO1xuXHRAT3V0cHV0KCdsZWFmbGV0RHJhd0VkaXRlZCcpIG9uRHJhd0VkaXRlZCA9IG5ldyBFdmVudEVtaXR0ZXI8RHJhd0V2ZW50cy5FZGl0ZWQ+KCk7XG5cdEBPdXRwdXQoJ2xlYWZsZXREcmF3RGVsZXRlZCcpIG9uRHJhd0RlbGV0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPERyYXdFdmVudHMuRGVsZXRlZD4oKTtcblx0QE91dHB1dCgnbGVhZmxldERyYXdTdGFydCcpIG9uRHJhd1N0YXJ0ID0gbmV3IEV2ZW50RW1pdHRlcjxEcmF3RXZlbnRzLkRyYXdTdGFydD4oKTtcblx0QE91dHB1dCgnbGVhZmxldERyYXdTdG9wJykgb25EcmF3U3RvcCA9IG5ldyBFdmVudEVtaXR0ZXI8RHJhd0V2ZW50cy5EcmF3U3RvcD4oKTtcblx0QE91dHB1dCgnbGVhZmxldERyYXdWZXJ0ZXgnKSBvbkRyYXdWZXJ0ZXggPSBuZXcgRXZlbnRFbWl0dGVyPERyYXdFdmVudHMuRHJhd1ZlcnRleD4oKTtcblx0QE91dHB1dCgnbGVhZmxldERyYXdFZGl0U3RhcnQnKSBvbkRyYXdFZGl0U3RhcnQgPSBuZXcgRXZlbnRFbWl0dGVyPERyYXdFdmVudHMuRWRpdFN0YXJ0PigpO1xuXHRAT3V0cHV0KCdsZWFmbGV0RHJhd0VkaXRNb3ZlJykgb25EcmF3RWRpdE1vdmUgPSBuZXcgRXZlbnRFbWl0dGVyPERyYXdFdmVudHMuRWRpdE1vdmU+KCk7XG5cdEBPdXRwdXQoJ2xlYWZsZXREcmF3RWRpdFJlc2l6ZScpIG9uRHJhd0VkaXRSZXNpemUgPSBuZXcgRXZlbnRFbWl0dGVyPERyYXdFdmVudHMuRWRpdFJlc2l6ZT4oKTtcblx0QE91dHB1dCgnbGVhZmxldERyYXdFZGl0VmVydGV4Jykgb25EcmF3RWRpdFZlcnRleCA9IG5ldyBFdmVudEVtaXR0ZXI8RHJhd0V2ZW50cy5FZGl0VmVydGV4PigpO1xuXHRAT3V0cHV0KCdsZWFmbGV0RHJhd0VkaXRTdG9wJykgb25EcmF3RWRpdFN0b3AgPSBuZXcgRXZlbnRFbWl0dGVyPERyYXdFdmVudHMuRWRpdFN0b3A+KCk7XG5cdEBPdXRwdXQoJ2xlYWZsZXREcmF3RGVsZXRlU3RhcnQnKSBvbkRyYXdEZWxldGVTdGFydCA9IG5ldyBFdmVudEVtaXR0ZXI8RHJhd0V2ZW50cy5EZWxldGVTdGFydD4oKTtcblx0QE91dHB1dCgnbGVhZmxldERyYXdEZWxldGVTdG9wJykgb25EcmF3RGVsZXRlU3RvcCA9IG5ldyBFdmVudEVtaXR0ZXI8RHJhd0V2ZW50cy5EZWxldGVTdG9wPigpO1xuXHRAT3V0cHV0KCdsZWFmbGV0RHJhd1Rvb2xiYXJPcGVuZWQnKSBvbkRyYXdUb29sYmFyT3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcjxEcmF3RXZlbnRzLlRvb2xiYXJPcGVuZWQ+KCk7XG5cdEBPdXRwdXQoJ2xlYWZsZXREcmF3VG9vbGJhckNsb3NlZCcpIG9uRHJhd1Rvb2xiYXJDbG9zZWQgPSBuZXcgRXZlbnRFbWl0dGVyPERyYXdFdmVudHMuVG9vbGJhckNsb3NlZD4oKTtcblx0QE91dHB1dCgnbGVhZmxldERyYXdNYXJrZXJDb250ZXh0Jykgb25EcmF3TWFya2VyQ29udGV4dCA9IG5ldyBFdmVudEVtaXR0ZXI8RHJhd0V2ZW50cy5NYXJrZXJDb250ZXh0PigpO1xuXG5cdGNvbnN0cnVjdG9yKGxlYWZsZXREaXJlY3RpdmU6IExlYWZsZXREaXJlY3RpdmUsIHByaXZhdGUgem9uZTogTmdab25lKSB7XG5cdFx0dGhpcy5sZWFmbGV0RGlyZWN0aXZlID0gbmV3IExlYWZsZXREaXJlY3RpdmVXcmFwcGVyKGxlYWZsZXREaXJlY3RpdmUpO1xuXHR9XG5cblx0bmdPbkluaXQoKSB7XG5cdFx0dGhpcy5sZWFmbGV0RGlyZWN0aXZlLmluaXQoKTtcblxuXHRcdC8vIENvbmZpZ3VyZSBsb2NhbGl6YXRpb24gb3B0aW9uc1xuXHRcdGlmKG51bGwgIT0gdGhpcy5kcmF3TG9jYWwpIHtcblx0XHRcdExlYWZsZXREcmF3VXRpbC5kZWVwTGl0ZXJhbENvcHkoZHJhd0xvY2FsLCB0aGlzLmRyYXdMb2NhbCk7XG5cdFx0fVxuXG5cdFx0Ly8gQ3JlYXRlIHRoZSBjb250cm9sXG5cdFx0dGhpcy5kcmF3Q29udHJvbCA9ICBuZXcgQ29udHJvbC5EcmF3KHRoaXMuZHJhd09wdGlvbnMpO1xuXG5cdFx0Ly8gQWRkIHRoZSBjb250cm9sIHRvIHRoZSBtYXBcblx0XHR0aGlzLmxlYWZsZXREaXJlY3RpdmUuZ2V0TWFwKCkuYWRkQ29udHJvbCh0aGlzLmRyYXdDb250cm9sKTtcblxuXHRcdC8vIFJlZ2lzdGVyIHRoZSBtYWluIGhhbmRsZXIgZm9yIGV2ZW50cyBjb21pbmcgZnJvbSB0aGUgZHJhdyBwbHVnaW5cblx0XHRjb25zdCBtYXAgPSB0aGlzLmxlYWZsZXREaXJlY3RpdmUuZ2V0TWFwKCk7XG5cblx0XHQvLyBhZGQgZHJhdyBldmVudCBwYXNzIHRocm91Z2hzXG5cdFx0bWFwLm9uKERyYXcuRXZlbnQuQ1JFQVRFRCwgKGU6IGFueSkgPT4gTGVhZmxldFV0aWwuaGFuZGxlRXZlbnQodGhpcy56b25lLCB0aGlzLm9uRHJhd0NyZWF0ZWQsIGUpKTtcblx0XHRtYXAub24oRHJhdy5FdmVudC5FRElURUQsIChlOiBEcmF3RXZlbnRzLkVkaXRlZCkgPT4gTGVhZmxldFV0aWwuaGFuZGxlRXZlbnQodGhpcy56b25lLCB0aGlzLm9uRHJhd0VkaXRlZCwgZSkpO1xuXHRcdG1hcC5vbihEcmF3LkV2ZW50LkRFTEVURUQsIChlOiBEcmF3RXZlbnRzLkRlbGV0ZWQpID0+IExlYWZsZXRVdGlsLmhhbmRsZUV2ZW50KHRoaXMuem9uZSwgdGhpcy5vbkRyYXdEZWxldGVkLCBlKSk7XG5cdFx0bWFwLm9uKERyYXcuRXZlbnQuRFJBV1NUQVJULCAoZTogRHJhd0V2ZW50cy5EcmF3U3RhcnQpID0+IExlYWZsZXRVdGlsLmhhbmRsZUV2ZW50KHRoaXMuem9uZSwgdGhpcy5vbkRyYXdTdGFydCwgZSkpO1xuXHRcdG1hcC5vbihEcmF3LkV2ZW50LkRSQVdTVE9QLCAoZTogRHJhd0V2ZW50cy5EcmF3U3RvcCkgPT4gTGVhZmxldFV0aWwuaGFuZGxlRXZlbnQodGhpcy56b25lLCB0aGlzLm9uRHJhd1N0b3AsIGUpKTtcblx0XHRtYXAub24oRHJhdy5FdmVudC5FRElUU1RBUlQsIChlOiBEcmF3RXZlbnRzLkVkaXRTdGFydCkgPT4gTGVhZmxldFV0aWwuaGFuZGxlRXZlbnQodGhpcy56b25lLCB0aGlzLm9uRHJhd0VkaXRTdGFydCwgZSkpO1xuXHRcdG1hcC5vbihEcmF3LkV2ZW50LkVESVRNT1ZFLCAoZTogRHJhd0V2ZW50cy5FZGl0TW92ZSkgPT4gTGVhZmxldFV0aWwuaGFuZGxlRXZlbnQodGhpcy56b25lLCB0aGlzLm9uRHJhd0VkaXRNb3ZlLCBlKSk7XG5cdFx0bWFwLm9uKERyYXcuRXZlbnQuRURJVFJFU0laRSwgKGU6IERyYXdFdmVudHMuRWRpdFJlc2l6ZSkgPT4gTGVhZmxldFV0aWwuaGFuZGxlRXZlbnQodGhpcy56b25lLCB0aGlzLm9uRHJhd0VkaXRSZXNpemUsIGUpKTtcblx0XHRtYXAub24oRHJhdy5FdmVudC5FRElUVkVSVEVYLCAoZTogRHJhd0V2ZW50cy5FZGl0VmVydGV4KSA9PiBMZWFmbGV0VXRpbC5oYW5kbGVFdmVudCh0aGlzLnpvbmUsIHRoaXMub25EcmF3RWRpdFZlcnRleCwgZSkpO1xuXHRcdG1hcC5vbihEcmF3LkV2ZW50LkVESVRTVE9QLCAoZTogRHJhd0V2ZW50cy5FZGl0U3RvcCkgPT4gTGVhZmxldFV0aWwuaGFuZGxlRXZlbnQodGhpcy56b25lLCB0aGlzLm9uRHJhd0VkaXRTdG9wLCBlKSk7XG5cdFx0bWFwLm9uKERyYXcuRXZlbnQuREVMRVRFU1RBUlQsIChlOiBEcmF3RXZlbnRzLkRlbGV0ZVN0YXJ0KSA9PiBMZWFmbGV0VXRpbC5oYW5kbGVFdmVudCh0aGlzLnpvbmUsIHRoaXMub25EcmF3RGVsZXRlU3RhcnQsIGUpKTtcblx0XHRtYXAub24oRHJhdy5FdmVudC5ERUxFVEVTVE9QLCAoZTogRHJhd0V2ZW50cy5EZWxldGVTdG9wKSA9PiBMZWFmbGV0VXRpbC5oYW5kbGVFdmVudCh0aGlzLnpvbmUsIHRoaXMub25EcmF3RGVsZXRlU3RvcCwgZSkpO1xuXHRcdG1hcC5vbihEcmF3LkV2ZW50LlRPT0xCQVJPUEVORUQsIChlOiBEcmF3RXZlbnRzLlRvb2xiYXJPcGVuZWQpID0+IExlYWZsZXRVdGlsLmhhbmRsZUV2ZW50KHRoaXMuem9uZSwgdGhpcy5vbkRyYXdUb29sYmFyT3BlbmVkLCBlKSk7XG5cdFx0bWFwLm9uKERyYXcuRXZlbnQuVE9PTEJBUkNMT1NFRCwgKGU6IERyYXdFdmVudHMuVG9vbGJhckNsb3NlZCkgPT4gTGVhZmxldFV0aWwuaGFuZGxlRXZlbnQodGhpcy56b25lLCB0aGlzLm9uRHJhd1Rvb2xiYXJDbG9zZWQsIGUpKTtcblxuXHRcdC8vIE5vdGlmeSBvdGhlcnMgdGhhdCB0aGUgZHJhdyBjb250cm9sIGhhcyBiZWVuIGNyZWF0ZWRcblx0XHR0aGlzLmRyYXdSZWFkeS5lbWl0KHRoaXMuZHJhd0NvbnRyb2wpO1xuXHR9XG5cblx0bmdPbkRlc3Ryb3koKSB7XG5cdFx0dGhpcy5sZWFmbGV0RGlyZWN0aXZlLmdldE1hcCgpLnJlbW92ZUNvbnRyb2wodGhpcy5kcmF3Q29udHJvbCk7XG5cdH1cblxuXHRwdWJsaWMgZ2V0RHJhd0NvbnRyb2woKSB7XG5cdFx0cmV0dXJuIHRoaXMuZHJhd0NvbnRyb2w7XG5cdH1cblxufVxuIl19